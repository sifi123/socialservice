<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Services</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .screen {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease-in;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #667eea;
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 10px;
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .balance-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .balance-card h2 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .balance-card p {
            font-size: 32px;
            font-weight: bold;
        }

        .service-card {
            border: 2px solid #e1e1e1;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            transition: border-color 0.3s;
        }

        .service-card:hover {
            border-color: #667eea;
        }

        .service-card.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .service-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .service-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }

        .service-options {
            display: none;
            margin-top: 15px;
        }

        .service-options.active {
            display: block;
        }

        .option-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .price-calculator {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .total-price {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
            text-align: center;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .payment-method {
            padding: 15px;
            border: 2px solid #e1e1e1;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .payment-method:hover, .payment-method.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .account-info {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .account-info h3 {
            color: #28a745;
            margin-bottom: 10px;
        }

        .task-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .task-reward {
            background: #28a745;
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 15px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.1);
            display: none;
        }

        .navigation.active {
            display: block;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-around;
        }

        .nav-btn {
            padding: 10px 15px;
            background: #f8f9fa;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .nav-btn.active {
            background: #667eea;
            color: white;
        }

        .notification {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 1px solid #c3e6cb;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }

        .file-upload {
            border: 2px dashed #ccc;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .file-upload:hover {
            border-color: #667eea;
        }

        .file-upload input {
            display: none;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .stat-card p {
            font-size: 14px;
            opacity: 0.9;
        }
  .whatsapp-btn {
        padding: 15px 25px;
        font-size: 16px;
        background-color: #25D366;
        color: white;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        font-weight: bold;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        transition: background-color 0.3s;
        }

.whatsapp-btn:hover {
  background-color: #1ebe5b;
}

    .logout-btn {
        padding: 8px 16px;
        font-size: 14px;
        width: auto;
        background: #dc3545;
        color: white;
        border: none;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
    }

    .logout-btn:hover {
        background: #c82333;
    }

    </style>  <script type="module">
  // Firebase Core + Auth + Database
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";
  import { getDatabase, ref, set, push, onValue } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";
  import { remove } from "https://www.gstatic.com/firebasejs/11.9.1/firebase-database.js";
window.firebaseRemove = remove;

  // Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyBS3hL2SWzaTnIrSQGqXym0BKkr0y01qEU",
    authDomain: "socialapp-678b6.firebaseapp.com",
    databaseURL: "https://socialapp-678b6-default-rtdb.firebaseio.com",
    projectId: "socialapp-678b6",
    storageBucket: "socialapp-678b6.firebasestorage.app",
    messagingSenderId: "102892089274",
    appId: "1:102892089274:web:f1f4c17265a79710783783"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  // Global Firebase exports for use in functions
  window.firebaseAuth = auth;
  window.firebaseDB = db;
  window.firebaseCreateUser = createUserWithEmailAndPassword;
  window.firebaseLoginUser = signInWithEmailAndPassword;
  window.firebaseSet = set;
  window.firebaseRef = ref;
  window.firebasePush = push;
  window.firebaseOnValue = onValue;
</script>

</head>
<body>
    <div class="container">
        <!-- Screen 1: Login/Signup -->
        <div class="screen active" id="authScreen">
            <div class="header">
                <h1>üöÄ Social Boost</h1>
                <p>Grow your social media presence</p>
            </div>
            
            <div id="loginForm">
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password">
                </div>
                <button class="btn" onclick="login()">Login</button>
                <button class="btn btn-secondary" onclick="showSignup()">Create Account</button>
            </div>

            <div id="signupForm" style="display: none;">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="signupName" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" id="signupEmail" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a password">
                </div>
                <button class="btn" onclick="signup()">Create Account</button>
                <button class="btn btn-secondary" onclick="showLogin()">Back to Login</button>
            </div>
        </div>

        <!-- Screen 2: Dashboard -->
        <div class="screen" id="dashboardScreen">
            <div class="header">
                <h1>Dashboard</h1>
                <p>Welcome back, <span id="userName">User</span>!</p>
            </div>

            <div class="balance-card">
                <h2>Total Balance</h2>
                <p>Rs <span id="userBalance">0</span></p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="totalOrders">0</h3>
                    <p>Total Orders</p>
                </div>
                <div class="stat-card">
                    <h3 id="totalEarnings">Rs 0</h3>
                    <p>Total Earnings</p>
                </div>
            </div>

            <button class="btn" onclick="showScreen('servicesScreen')">Order Services</button>
            <button class="btn btn-secondary" onclick="showScreen('earningsScreen')">View Earnings</button>
        </div>

        <!-- Screen 3: Services -->
        <div class="screen" id="servicesScreen">
            <div class="header">
                <h1>Social Services</h1>
                <p>Choose your platform and service</p>
            </div>

            <div class="service-card" onclick="selectService('tiktok')">
                <div class="service-header">
                    <div class="service-icon" style="background: #ff0050;">T</div>
                    <h3>TikTok</h3>
                </div>
                <div class="service-options" id="tiktokOptions">
                    <div class="option-row">
                        <span>1 Follower</span>
                        <span>Rs 2</span>
                    </div>
                    <div class="option-row">
                        <span>5 Likes</span>
                        <span>Rs 1</span>
                    </div>
                </div>
            </div>

            <div class="service-card" onclick="selectService('facebook')">
                <div class="service-header">
                    <div class="service-icon" style="background: #1877f2;">F</div>
                    <h3>Facebook</h3>
                </div>
                <div class="service-options" id="facebookOptions">
                    <div class="option-row">
                        <span>1 Follower</span>
                        <span>Rs 2</span>
                    </div>
                    <div class="option-row">
                        <span>5 Likes</span>
                        <span>Rs 1</span>
                    </div>
                </div>
            </div>

            <div class="service-card" onclick="selectService('youtube')">
                <div class="service-header">
                    <div class="service-icon" style="background: #ff0000;">Y</div>
                    <h3>YouTube</h3>
                </div>
                <div class="service-options" id="youtubeOptions">
                    <div class="option-row">
                        <span>1 Subscriber</span>
                        <span>Rs 2</span>
                    </div>
                    <div class="option-row">
                        <span>5 Likes</span>
                        <span>Rs 1</span>
                    </div>
                </div>
            </div>

            <div class="service-card" onclick="selectService('instagram')">
                <div class="service-header">
                    <div class="service-icon" style="background: linear-gradient(45deg, #f09433 0%,#e6683c 25%,#dc2743 50%,#cc2366 75%,#bc1888 100%);">I</div>
                    <h3>Instagram</h3>
                </div>
                <div class="service-options" id="instagramOptions">
                    <div class="option-row">
                        <span>1 Follower</span>
                        <span>Rs 2</span>
                    </div>
                    <div class="option-row">
                        <span>5 Likes</span>
                        <span>Rs 1</span>
                    </div>
                </div>
            </div>

            <div class="service-card" onclick="selectService('twitter')">
                <div class="service-header">
                    <div class="service-icon" style="background: #1da1f2;">X</div>
                    <h3>Twitter</h3>
                </div>
                <div class="service-options" id="twitterOptions">
                    <div class="option-row">
                        <span>1 Follower</span>
                        <span>Rs 2</span>
                    </div>
                    <div class="option-row">
                        <span>5 Likes</span>
                        <span>Rs 1</span>
                    </div>
                </div>
            </div>

            <div id="orderForm" style="display: none;">
                <div class="form-group">
                    <label>Account Link</label>
                    <input type="url" id="accountLink" placeholder="Paste your account/post link">
                </div>
                <div class="form-group">
                    <label>Service Type</label>
                    <select id="serviceType">
                        <option value="">Select Service</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Quantity</label>
                    <input type="number" id="quantity" placeholder="Enter quantity" min="1" oninput="calculateTotal()">
                </div>
                
                <div class="price-calculator">
                    <div class="total-price">Total: Rs <span id="totalPrice">0</span></div>
                </div>

                <button class="btn" onclick="proceedToPayment()">Proceed to Payment</button>
            </div>
        </div>

        <!-- Screen 4: Payment -->
        <div class="screen" id="paymentScreen">
            <div class="header">
                <h1>Payment</h1>
                <p>Choose your payment method</p>
            </div>

            <div class="payment-methods">
                <div class="payment-method" onclick="selectPaymentMethod('easypaisa')">
                    <h3>EasyPaisa</h3>
                    <p>Mobile Payment</p>
                </div>
                <div class="payment-method" onclick="selectPaymentMethod('jazzcash')">
                    <h3>JazzCash</h3>
                    <p>Mobile Payment</p>
                </div>
            </div>

            <div class="account-info">
                <h3>Payment Details</h3>
                <p><strong>Name:</strong> Saifullah</p>
                <p><strong>Number:</strong> 0336769498</p>
                <p><strong>Amount:</strong> Rs <span id="paymentAmount">0</span></p>
            </div>

            <div class="form-group">
                <label>Transaction ID</label>
                <input type="text" id="transactionId" placeholder="Enter transaction ID">
            </div>

            <div class="form-group">
                <label>Upload Screenshot</label>
                <div class="file-upload" onclick="document.getElementById('screenshot').click()">
                    <input type="file" id="screenshot" accept="image/*" onchange="handleFileUpload(this)">
                    <p id="fileUploadText">üì∑ Click to upload screenshot</p>
                </div>
            </div>

            <button class="btn" onclick="submitPayment()">Submit Payment</button>
            <div class="form-group">
            <label>Withdraw Method</label>
           <select id="withdrawMethod">
           <option value="">Select Method</option>
          <option value="easypaisa">EasyPaisa</option>
          <option value="jazzcash">JazzCash</option>
          </select>
          </div>
            <div style="margin-top: 30px;">
                <h3>Withdraw Funds</h3>
                <div class="form-group">
                    <label>Account Name</label>
                    <input type="text" id="withdrawName" placeholder="Enter account name">
                </div>
                
                <div class="form-group">
                <label>Account Number</label>
                <input type="text" id="withdrawNumber" placeholder="Enter account number">
                </div>

                <div class="form-group">
                    <label>Amount (Min Rs 300)</label>
                    <input type="number" id="withdrawAmount" placeholder="Enter amount" min="300">
                </div>
                <button class="btn btn-secondary" onclick="requestWithdraw()">Request Withdraw</button>
                <p style="font-size: 12px; color: #666; margin-top: 10px;">
                    * Withdrawal will be processed within 30 minutes
                </p>
            </div>
        </div>

        <!-- Screen 5: Earnings -->
        <div class="screen" id="earningsScreen">
            <div class="header">
                <h1>Earnings</h1>
                <p>Complete tasks and earn coins</p>
            </div>

            <div class="balance-card">
                <h2>Available Tasks</h2>
                <p id="availableTasks">0</p>
            </div>

            <div id="tasksList">
                <!-- Tasks will be dynamically added here -->
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="completedTasks">0</h3>
                    <p>Completed Tasks</p>
                </div>
                <div class="stat-card">
                    <h3 id="earnedCoins">Rs 0</h3>
                    <p>Earned Today</p>
                </div>
            </div>
        </div>

       <!-- Screen 6: Contact -->
<div class="screen" id="contactScreen">
  <div class="header">
    <h1>üìû Contact Us</h1>
    <p>Reach us directly on WhatsApp</p>
  </div>

  <div style="text-align: center; margin-top: 40px;">
    <a href="https://wa.me/923367169498?text=Hello%20I%20need%20help%20with%20your%20website" target="_blank">
      <button class="whatsapp-btn">üí¨ Message on WhatsApp</button>
    </a>
    <p style="margin-top: 10px; color: #555;">Available 9AM‚Äì9PM Daily</p>
  </div>
</div>


    <!-- Navigation -->
    <div class="navigation" id="navigation">
        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showScreen('dashboardScreen')">Dashboard</button>
            <button class="nav-btn" onclick="showScreen('servicesScreen')">Services</button>
            <button class="nav-btn" onclick="showScreen('paymentScreen')">Payment</button>
            <button class="nav-btn" onclick="showScreen('earningsScreen')">Earnings</button>
            <button class="nav-btn" onclick="showScreen('contactScreen')">Contact</button>
            <button class="logout-btn" onclick="logout()">Logout</button>

    </div>
    </div>

    <script>
       // üß† Core user data
let userData = {
    name: '',
    email: '',
    balance: 0,
    totalOrders: 0,
    totalEarnings: 0,
    completedTasks: 0,
    earnedToday: 0
};

let currentOrder = {
    platform: '',
    service: '',
    quantity: 0,
    total: 0,
    link: ''
};

let tasks = [];

function showScreen(screenId) {
    document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
    document.getElementById(screenId).classList.add('active');
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    if (screenId !== 'authScreen') {
        document.getElementById('navigation').classList.add('active');
    } else {
        document.getElementById('navigation').classList.remove('active');
    }
}

function showLogin() {
    document.getElementById('loginForm').style.display = 'block';
    document.getElementById('signupForm').style.display = 'none';
}

function showSignup() {
    document.getElementById('loginForm').style.display = 'none';
    document.getElementById('signupForm').style.display = 'block';
}


function signup() {
  const name = document.getElementById('signupName').value;
  const email = document.getElementById('signupEmail').value;
  const password = document.getElementById('signupPassword').value;

  if (name && email && password) {
    firebaseCreateUser(firebaseAuth, email, password)
      .then((userCredential) => {
        const user = userCredential.user;
        // Save extra user info to database
        const uid = user.uid;
        firebaseSet(firebaseRef(firebaseDB, 'users/' + uid), {
          name: name,
          email: email,
          balance: 0,
          totalOrders: 0,
          totalEarnings: 0,
          completedTasks: 0,
          earnedToday: 0
        });
        alert("Account created successfully. Please login.");
        showLogin();
      })
      .catch((error) => {
        alert("Signup error: " + error.message);
      });
  } else {
    alert('Please fill in all fields');
  }
}

function login() {
  const email = document.getElementById('loginEmail').value;
  const password = document.getElementById('loginPassword').value;

  firebaseLoginUser(firebaseAuth, email, password)
    .then((userCredential) => {
      const user = userCredential.user;
      const uid = user.uid;

      // Load user data from Firebase
      firebaseOnValue(firebaseRef(firebaseDB, 'users/' + uid), (snapshot) => {
        const data = snapshot.val();
        if (data) {
          userData = data;
          updateUserData();
          showScreen('dashboardScreen');
          generateTasks();
        }
      });
    })
    .catch((error) => {
      alert("Login failed: " + error.message);
    });
}


function updateUserData() {
    document.getElementById('userName').textContent = userData.name;
    document.getElementById('userBalance').textContent = userData.balance;
    document.getElementById('totalOrders').textContent = userData.totalOrders;
    document.getElementById('totalEarnings').textContent = `Rs ${userData.totalEarnings}`;
    document.getElementById('completedTasks').textContent = userData.completedTasks;
    document.getElementById('earnedCoins').textContent = `Rs ${userData.earnedToday}`;
    document.getElementById('availableTasks').textContent = tasks.filter(t => !t.completed).length;
}

function selectService(platform) {
    document.querySelectorAll('.service-card').forEach(card => {
        card.classList.remove('selected');
        card.querySelector('.service-options').classList.remove('active');
    });
    event.currentTarget.classList.add('selected');
    document.getElementById(platform + 'Options').classList.add('active');
    document.getElementById('orderForm').style.display = 'block';
    const serviceSelect = document.getElementById('serviceType');
    serviceSelect.innerHTML = '<option value="">Select Service</option>';
    if (platform === 'youtube') {
        serviceSelect.innerHTML += '<option value="subscriber">1 Subscriber - Rs 1</option>';
        serviceSelect.innerHTML += '<option value="like">10 Likes - Rs 1</option>';
    } else {
        serviceSelect.innerHTML += '<option value="follower">1 Follower - Rs 1</option>';
        serviceSelect.innerHTML += '<option value="like">10 Likes - Rs 1</option>';
    }
    currentOrder.platform = platform;
}

function calculateTotal() {
    const quantity = parseInt(document.getElementById('quantity').value) || 0;
    const total = quantity * 1;
    document.getElementById('totalPrice').textContent = total;
    currentOrder.quantity = quantity;
    currentOrder.total = total;
}

function proceedToPayment() {
    const link = document.getElementById('accountLink').value;
    const service = document.getElementById('serviceType').value;
    const quantity = parseInt(document.getElementById('quantity').value);
    if (!link || !service || !quantity) {
        alert('Please fill in all fields');
        return;
    }
    currentOrder.link = link;
    currentOrder.service = service;
    document.getElementById('paymentAmount').textContent = currentOrder.total;
    showScreen('paymentScreen');
}

function selectPaymentMethod(method) {
    document.querySelectorAll('.payment-method').forEach(pm => pm.classList.remove('selected'));
    event.currentTarget.classList.add('selected');
}

function handleFileUpload(input) {
    if (input.files && input.files[0]) {
        document.getElementById('fileUploadText').textContent = '‚úÖ Screenshot uploaded';
    }
}

function submitPayment() {
    const transactionId = document.getElementById('transactionId').value;
    const screenshot = document.getElementById('screenshot').files[0];
    if (!transactionId || !screenshot) {
        alert('Please provide transaction ID and screenshot');
        return;
    }
    const notification = document.createElement('div');
    notification.className = 'notification';
    notification.innerHTML = '‚úÖ Payment submitted successfully! Your order will be processed within 24 hours.';
    document.getElementById('paymentScreen').insertBefore(notification, document.getElementById('paymentScreen').firstChild);
    userData.totalOrders++;
    updateUserData();
    firebaseSet(firebaseRef(firebaseDB, 'users/' + firebaseAuth.currentUser.uid), userData);
    document.getElementById('transactionId').value = '';
    document.getElementById('screenshot').value = '';
    document.getElementById('fileUploadText').textContent = 'üì∑ Click to upload screenshot';
    addTaskFromOrder();
}

function addTaskFromOrder() {
    for (let i = 0; i < currentOrder.quantity; i++) {
        const newTask = {
            platform: currentOrder.platform,
            service: currentOrder.service,
            reward: 1,
            completed: false,
            link: currentOrder.link
        };

        // ‚úÖ Firebase mein task save karo
        firebasePush(firebaseRef(firebaseDB, 'tasks'), newTask);

        // Optional: local task list mein bhi dalo (display ke liye)
        tasks.push({ ...newTask, id: tasks.length + 1 });
    }

    updateUserData();
    renderTasks();
}


function generateTasks() {
  firebaseOnValue(firebaseRef(firebaseDB, 'tasks'), (snapshot) => {
    tasks = [];
    snapshot.forEach((child) => {
      const task = child.val();
      task.id = child.key;
      tasks.push(task);
    });
    renderTasks();
    updateUserData();
  });
}


function renderTasks() {
    const tasksList = document.getElementById('tasksList');
    tasksList.innerHTML = '';
    tasks.forEach(task => {
        if (task.completed) return;
        const div = document.createElement('div');
        div.className = 'task-card';

        const fileInputId = `screenshot-${task.id}`;
        const buttonId = `complete-btn-${task.id}`;

        div.innerHTML = `
            <div class="task-header">
                <strong>${task.platform} - ${task.service}</strong>
                <span class="task-reward">Rs ${task.reward}</span>
            </div>
            <p>üîó <a href="${task.link}" target="_blank">${task.link}</a></p>
            <div class="form-group">
                <label>Upload Screenshot</label>
                <input type="file" accept="image/*" id="${fileInputId}">
            </div>
            <button class="btn" id="${buttonId}" style="display:none;">‚úÖ Complete Task</button>
        `;

        tasksList.appendChild(div);

        // Add event listener for screenshot input
        const fileInput = document.getElementById(fileInputId);
        const completeBtn = document.getElementById(buttonId);

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length) {
                completeBtn.style.display = 'block';
            }
        });

        // Complete button click
      completeBtn.addEventListener('click', () => {
    // Update local user data
    task.completed = true;
    userData.completedTasks++;
    userData.earnedToday += task.reward;
    userData.balance += task.reward;

    updateUserData();
   alert('‚úÖ Task submitted successfully! Rs 1 added to your balance.');
setTimeout(() => {
  showScreen('earningsScreen');
}, 300);  // Delay 0.3 second to override any accidental jump


    // üî• Delete task from Firebase (so no one else sees it)
    firebaseRemove(firebaseRef(firebaseDB, 'tasks/' + task.id))
      .then(() => {
        renderTasks(); // Refresh task list
      })
      .catch((err) => {
        alert("‚ùå Error removing task: " + err.message);
      });

    // üîÑ Save updated balance & stats to Firebase
    firebaseSet(firebaseRef(firebaseDB, 'users/' + firebaseAuth.currentUser.uid), userData);
});

    });
}

function submitTask(input, taskId) {
    if (!input.files.length) {
        alert('Please upload screenshot');
        return;
    }
    const task = tasks.find(t => t.id === taskId);
    if (task) {
        task.completed = true;
        userData.completedTasks++;
        userData.earnedToday += task.reward;
        userData.balance += task.reward;
        updateUserData();
        renderTasks();
        alert('‚úÖ Task submitted successfully! Rs 1 added to your balance.');

    }
}

function requestWithdraw() {
    const name = document.getElementById('withdrawName').value;
    const method = document.getElementById('withdrawMethod').value;
    const number = document.getElementById('withdrawNumber').value;
    const amount = parseInt(document.getElementById('withdrawAmount').value);
    
    if (!name || !method || !number || !amount || amount < 300) {
        alert('Please fill in all fields. Minimum withdrawal is Rs 300.');
        return;
    }

    if (amount > userData.balance) {
        alert('Insufficient balance');
        return;
    }

    const data = {
        name: name,
        method: method,
        number: number,
        amount: amount,
        status: "pending",
        date: new Date().toISOString()
    };

    // üîÅ Firebase Save
    firebasePush(firebaseRef(firebaseDB, "withdrawals"), data)
        .then(() => {
            alert("‚úÖ Withdrawal request submitted and saved to Firebase!");
            userData.balance -= amount;
            updateUserData();
            firebaseSet(firebaseRef(firebaseDB, 'users/' + firebaseAuth.currentUser.uid), userData);

            // Reset form
            document.getElementById('withdrawName').value = '';
            document.getElementById('withdrawMethod').value = '';
            document.getElementById('withdrawNumber').value = '';
            document.getElementById('withdrawAmount').value = '';
        })
        .catch((err) => {
            alert("‚ùå Failed to save request: " + err.message);
        });
}

function logout() {
    // Local storage clear karo (agar use ho rahi ho)
    localStorage.removeItem('user');

    // User data reset karo
    userData = {
        name: '',
        email: '',
        balance: 0,
        totalOrders: 0,
        totalEarnings: 0,
        completedTasks: 0,
        earnedToday: 0
    };

    // Tasks clear karo
    tasks = [];

    // Show only login screen
    showScreen('authScreen');
    showLogin(); // Show login form by default

    // Input fields clear karo
    document.getElementById('loginEmail').value = '';
    document.getElementById('loginPassword').value = '';
}


</script>
</body>
</html>
